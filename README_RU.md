<h1>BackEnd сервер для управления данными компании</h1>

<p>Данное приложение представляет собой BackEnd сервер для управления данными компании, такими как: сотрудники, продажи, товары, филиалы и инвентаризация. FrontEnd часть доступна <a href="https://github.com/yunusmi/company_crud_app_front_end/blob/master/README_RU.md">здесь</a>.</p>

<h2>Используемые технологии:</h2>
<ul>
  <li><strong>NodeJS</strong></li>
  <li><strong>Express</strong> фреймворк</li>
  <li><strong>TypeScript</strong></li>
  <li><strong>ORM</strong>: Sequelize</li>
  <li><strong>База данных</strong>: MySQL</li>
  <li><strong>Документация API</strong>: Swagger (доступна на development окружении по URI: /api-docs/v1)</li>
</ul>

<p>Клиент и сервер взаимодействуют между собой по протоколу HTTP, архитектурным стилем REST API в формате JSON.</p>

<h2>Настройка</h2>

<p><strong>Предварительные требования:</strong></p>
<ul>
  <li>Установленная база данных MySQL не ниже 5.7</li>
  <li>Установленная версия NodeJS не ниже 17.0.</li>
  <li>Стабильное подключение к интернету (требуется для загрузки необходимых зависимостей клиента)</li>
</ul>

<ol>
  <li>Для начала настройки, необходимо создать папку для проекта и затем склонировать удаленный репозиторий проекта:
    <pre><code>git clone https://github.com/yunusmi/company_crud_app_backend.git .</code></pre>
    </li>
  <li>Потом, нужно установить зависимости проекта командой: 
  <pre><code>npm install</code></pre>
  </li>
  <li>После установки зависимостей, необходимо создать базу данных в MySQL для приложения, который затем указывается в файле конфигурации проекта.</li>
  <li>После создания базы данных, необходимо создать файл конфигурации <b>.env</b> по образцу <b>.env.example</b> и вставить данные для работы приложения.</li>
</ol>

<h3>Описание параметров:</h3>
<ul>
  <li><strong>APP_PORT</strong> - отвечает за порт приложения NodeJS (по умолчанию, порт 3000)</li>
  <li><strong>APP_HOST</strong> - хост приложения NodeJS (по умолчанию localhost)</li>

  <li><strong>DB_DEV_HOST</strong> - хост базы данных для режима разработки (если база данных установлена локально, то нужно оставить 127.0.0.1)</li>
  <li><strong>DB_DEV_USERNAME</strong> - имя пользователя базы данных для режима разработки (dev)</li>
  <li><strong>DB_DEV_PASSWORD</strong> - пароль пользователя базы данных для режима разработки (dev)</li>
  <li><strong>DB_DEV_NAME</strong> - название базы данных для режима разработки (dev)</li>
  <li><strong>DB_DEV_DIALECT</strong> - тип базы данных (по умолчанию - mysql)</li>

  <li><strong>DB_PROD_HOST</strong> - хост базы данных для запуска приложения в production</li>
  <li><strong>DB_PROD_USERNAME</strong> - имя пользователя базы данных для запуска приложения в production</li>
  <li><strong>DB_PROD_PASSWORD</strong> - пароль пользователя базы данных для запуска приложения в production</li>
  <li><strong>DB_PROD_NAME</strong> - название базы данных для запуска приложения в production</li>
  <li><strong>DB_PROD_DIALECT</strong> - тип базы данных (по умолчанию - mysql)</li>
</ul>

<p><b>Пояснение:</b> среда запуска бывает development (режим разработки) и production (на удаленном сервере) и для каждого из них необходимо указывать свою базу данных. Но прежде чем разворачивать приложение на production сервере, рекомендуется протестировать и запускать приложение в режиме development (работа на локальном ПК), только потом уже развернуть приложение на реальном production сервере.</p>

<h2>Миграция таблиц базы данных и их первичное заполнение</h2>

<p>Для создания таблиц для работы приложения, нужно сделать миграцию таблиц, а затем заполнить их первоначальными данными.</p>

<p>Выполните команду:</p>

<pre><code>npm run db:migrate:up:development</code></pre>

<p>для создания таблиц приложения для окружения development. Система автоматически создаст необходимые для приложения таблицы, используя данные конфигурации базы данных.</p>

<p>Если приложение настраивается на удаленном сервере (в среде production), то выполните эту команду:</p>

<pre><code>npm run db:migrate:up:production</code></pre>

<p>Система автоматически создаст необходимые для приложения таблицы, используя данные конфигурации базы данных для production сервера.</p>

<p>После окончания создания таблиц, нужно заполнить их первоначальными данными.</p>

<p>Для development используйте команду:</p>

<pre><code>npm run db:seed:all:development</code></pre>

<p>Для production используйте команду:</p>

<pre><code>npm run db:seed:all:production</code></pre>

<p>Система автоматически вставит первоначальные данные и заполнит таблицы в базе данных приложения.</p>

<h2>Запуск</h2>

<p>Для запуска на локальном сервере (development), введите команду:</p>

<pre><code>npm run start:development</code></pre>

<p>Теперь вы можете запускать FrontEnd клиент, перед этим не забыв указать в файле конфигурации клиента (перед компиляцией, файл <b>config.js</b>) адрес и порт BackEnd приложения.</p>

<p>На этом заканчивается настройка запуск приложения на локальном (development) окружении. Вы можете изменять и дополнять функционал приложения. Дальнейшие инструкции касаются настройки на production сервере (допустим, вы обновили функционал приложения и хотите запустить приложение на удаленном сервере).</p>

<h2>Настройка приложения на удаленном сервере в режиме production</h2>

<p>В первую очередь необходимо создать папку для проекта и закинуть файлы вашего локального проекта на удаленный сервер при помощи FTP или испольуя git (используйте команду на удаленном сервере: <code>git clone [удаленный репозиторий].git</code>).</p>

<p>Повторите команды с установкой зависимостей, настройки базы данных, миграции таблиц и их первоначальное заполнение данными на удаленном сервере.</p>

<p>Затем нужно скомпилировать проект (так как приложение было написано на TypeScript, необходимо ее скомпилировать на JavaScript). Для этого испольуйте команду:</p>

<pre><code>npm run compile-project</code></pre>

<p>который создаст папку <b>dist</b>, который будет содержать скомпилированный в JavaScript приложение.</p>

<p>Далее нужно выполнить команду:</p>

<pre><code>npm run start:production</code></pre>

<p>которая запускает приложение в фоновом режиме.</p>

<p>Теперь приложение доступно удаленно.</p>

<p>Для просмотра логов и отладки ошибок, используйте команду:</p>

<pre><code>npm run log</code></pre>

<p>Для остановки приложения используйте команду:</p>

<pre><code>npm run stop:production</code></pre>

<p>Дополнительно можно настроить домен, сменить порт приложения, а также настроить HTTPS для защищенного соединения между клиентским приложением и удаленным сервером.</p>

<p>Также, не забудьте изменить конфигурацию клиента на новые данные сервера (адрес, протокол и порт).</p>

<h2>Заключение</h2>

<p>Этот проект распространяется под лицензией MIT. Вы можете использовать весь код этого проекта на своих проектах абсолютно бесплатно.</p>

<p>Если вам нужна моя помощь или консультация, вы можете связаться со мной по электронной почте: <a href="mailto:contact@yunus-mil.ru">contact@yunus-mil.ru</a>.</p>
